#include "../master_header.h"
#include "../filtroImagenes.h"
#include "../matriz.h"
#include "../imagenes.h"

using namespace std;

int main( int argc, char** argv )
{
	double porcentaje =  atof(argv[2]);
	double reduccion =  atof(argv[3]);
	Imagenes *imagenL = new Imagenes( argv[1] );

	imagenL->componerImagen( "sinRuido.pgm");

	FiltroImagenes filter ( imagenL->ancho,imagenL->alto, imagenL->maxVal, 31);
	filter.ruido_normal( *(imagenL->pixeles), 20 );
	imagenL->componerImagen( "predenoiser.pgm");
	
	printf( "psnr con ruido: %f\n", imagenL->PSNR() );

	filter.denoiser_umbral(*(imagenL->pixeles), porcentaje, reduccion);
	imagenL->componerImagen( "filtrada.pgm");

	printf("\n\n\n\n");

	printf( "psnr filtrada: %f\n", imagenL->PSNR() );

	delete imagenL;


	return 0;
}
